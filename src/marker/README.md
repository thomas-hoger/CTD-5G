# Marker Packets â€” CTD5G Dataset

## Overview

This document details the design and purpose of **marker packets** used within the CTD5G (Control Traffic Dataset for 5G Networks) to enable labeling of both malicious and benign procedures.

In many 5G datasets, labeling methods typically fix either the **temporal** or **identity** context to separate benign from malicious traffic. However, we argue that both contexts are crucial and should be preserved. To maintain identity consistency during attack execution while enabling anonymization in post-processing, we introduce custom marker packets.

## Marker Usage for Attacks

Attacks are always launched from a fixed attacker IP address to ensure identity coherence across multi-packet sequences. During post-processing, this IP is modified to anonymize the attacker while preserving the internal consistency of the flow.

To detect attack boundaries accurately, we insert special **marker packets** at the **beginning** and **end** of each attack. These markers define the attack scope for labeling and IP address rewriting.

Each marker are identified by:
- A unique format marking it as a control packet
- The **attack type**, embedded in the payload
- The same source IP as the attacker (to be replaced post-capture)

> [!WARNING]
> Benign traffic may appear between the markers because attack and benign procedures are executed concurrently. However, since it does not originate from the attacker's IP address, it is excluded from address rewriting and can be filtered out during analysis.

## Marker Usage for Benign Procedures

To estimate the number of packets generated by each benign procedure, we apply the same marker mechanism to benign sequences. Each benign procedure is enclosed between a pair of marker packets, allowing approximate measurement of the associated traffic volume.

## Known Limitations

Although markers enable fine-grained labeling and address rewriting, the current implementation could be further improved:

- Currently we modify packet-level fields (e.g., IP addresses) but do **not** recompute checksums. 
- Only the IP addresses are changed during anonymization; **MAC addresses are left unchanged**.

